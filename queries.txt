1) Investigating aton signals present in ais_data:
	we want:
		>types of atons
		>which aton is most common
		>order by significance (count)

select distinct count(*), ais_data.dynamic_aton.typeofaid, ais_status_codes_types.aton.definition
	from ais_data.dynamic_aton, ais_status_codes_types.aton
	where ais_status_codes_types.aton.id_code=ais_data.dynamic_aton.typeofaid
	group by ais_data.dynamic_aton.typeofaid,ais_status_codes_types.aton.definition
	order by count(*) ;


2) Find count of ships with different types 

	select count(distinct sourcemmsi), ship_types.type_name
	from ais_data.static_ships,  ais_status_codes_types.ship_types
	where shiptype between shiptype_min and shiptype_max 
	group by type_name

3) Find ships' avg, min, max speed: 

	select avg(speed), max(speed), min(speed)
	from ais_data.dynamic_ships
	where speed > 0;

avg 		  max	min
15.7915488991632; 102.3; 0.1

4) ToDo: na eisagoume sto where an vrisketai se limani h oxi
	select distinct (mmsi), lat, lon
	from ais_data.dynamic_ships
	where speed = 0;


5) The cargo vessels that do not have load:

	select distinct sourcemmsi, ship_types.type_name
from ais_data.static_ships,  ais_status_codes_types.ship_types
where shiptype between shiptype_min and shiptype_max and type_name like 'Cargo%' and draught = 0;

6) How many vessels are routed to Brest's port and how many are just passing or beginning from Brest's port

	select count (distinct sourcemmsi)
	from ais_data.static_ships
	where destination LIKE 'BREST%'
	
	Result: 194 vessels

	select count (distinct sourcemmsi)
	from ais_data.static_ships
	where destination not LIKE 'BREST%'

	Result: 4431 vessels

7) Find the origin of ships

	select distinct(sourcemmsi), country
	from ais_data.static_ships, ais_status_codes_types.mmsi_country_codes
	where substring(cast(sourcemmsi as varchar),1,3) = country_code::text

8)There are many ships that has no origin

	select distinct(sourcemmsi) from ais_data.static_ships where sourcemmsi not in 		(select distinct(sourcemmsi)
	from ais_data.static_ships, ais_status_codes_types.mmsi_country_codes
	where substring(cast(sourcemmsi as varchar),1,3) = country_code::text)
	order by sourcemmsi

9) percentage of messages per type of ship

	select (cast(count(sourcemmsi) as FLOAT)/1078617)*100, ship_types.type_name
	from ais_data.static_ships,  ais_status_codes_types.ship_types
	where shiptype between shiptype_min and shiptype_max 
	group by type_name
10) In which three month time there are more messages
 messages from 10 - 11 - 12/2015

	select count(dynamic_ships.mmsi)
	from ais_data.dynamic_ships
	where ts > 1443657601 and ts < 1451520001
Results: 9047313

messages from 1 - 2 - 3/2016
	select count(dynamic_ships.mmsi)
	from ais_data.dynamic_ships
	where ts > 1451606401 and ts < 1459382401
Results: 9808823

11)Number of unique ships in Natura areas (france)

with cte as 
(
    select * from ais_data.dynamic_ships LIMIT 100000
)

	select  count (distinct cte.mmsi)
	from natura2000.spatialfeatures, natura2000.sites, cte  where
	natura2000.spatialfeatures.sitecode=natura2000.sites.sitecode and natura2000.sites.country_code='fr'
	and ST_Contains(natura2000.spatialfeatures.geom,ST_Transform(cte.geom,3035))=true;
Results:64 ** Note: If the limit is removed, then the command will run for all rows in ais_data.dynamic_ships

12)Number of virtual/physical Atons:
	select VirtualAtons,PhysicalAtons from (select count(*) from ais_data.dynamic_aton where virtual=true) as VirtualAtons,
	(select count(*) from ais_data.dynamic_aton where virtual=false) as PhysicalAtons;
Results: 
	Virtual Atons->25259
	Physical Atons->480458 
	**Note** Physical Atons are:Lighthouses,beacons(they send navigational information)
		 Virtual Atons:authority transmits navigational information where no physical aton exists (broadcast messages or messages targeted to a specific vessel/mmsi)

